# 布尔值字段判定检查清单

## 问题说明

根据最新的数据库设计，所有布尔值字段都使用 TINYINT(1) 类型：
- `1` 表示 true/是/启用
- `2` 表示 false/否/禁用

前端代码中需要将所有布尔值判定从 JavaScript 的 `true/false` 改为 `=== 1` 和 `=== 2` 的判定方式。

## 涉及的字段

| 字段名 | 含义 | 1 表示 | 2 表示 |
|--------|------|--------|--------|
| `is_creator` | 是否创建者 | 是创建者 | 不是创建者 |
| `is_default` | 是否默认 | 是默认 | 不是默认 |
| `is_disable` | 是否禁用 | 启用 | 禁用 |
| `is_system` | 是否系统标签 | 系统标签 | 用户自定义标签 |
| `is_auto_generated` | 是否自动生成 | 自动生成 | 手动输入 |
| `is_recurring_enabled` | 是否启用周期 | 启用 | 禁用 |
| `is_show_home` | 是否显示在首页 | 显示 | 不显示 |

## 需要修复的文件

### 1. `/pages/account-books/index.vue`

**问题位置**:
- 第 227 行: `this.createdBooks = data.filter(book => book.is_creator);`
- 第 228 行: `this.joinedBooks = data.filter(book => !book.is_creator);`
- 第 289 行: `this.isBookCreator = book.is_creator;`

**修复方案**:
```javascript
// 修复前
this.createdBooks = data.filter(book => book.is_creator);
this.joinedBooks = data.filter(book => !book.is_creator);
this.isBookCreator = book.is_creator;

// 修复后
this.createdBooks = data.filter(book => book.is_creator === 1);
this.joinedBooks = data.filter(book => book.is_creator === 2);
this.isBookCreator = book.is_creator === 1;
```

### 2. `/pages/record/index.vue`

**问题位置**:
- 第 635 行: `this.createdBooks = books.filter(b => b.is_creator);`
- 第 636 行: `this.joinedBooks = books.filter(b => !b.is_creator);`
- 第 642 行: `const defaultBook = books.find(b => b.is_default) || books[0];`

**修复方案**:
```javascript
// 修复前
this.createdBooks = books.filter(b => b.is_creator);
this.joinedBooks = books.filter(b => !b.is_creator);
const defaultBook = books.find(b => b.is_default) || books[0];

// 修复后
this.createdBooks = books.filter(b => b.is_creator === 1);
this.joinedBooks = books.filter(b => b.is_creator === 2);
const defaultBook = books.find(b => b.is_default === 1) || books[0];
```

### 3. `/pages/home/index.vue`

**问题位置**:
- 第 759 行: `this.createdBooks = books.filter(b => b.is_creator);`
- 第 760 行: `this.joinedBooks = books.filter(b => !b.is_creator);`
- 第 774 行: `const defaultBook = books.find(b => b.is_default);`

**修复方案**:
```javascript
// 修复前
this.createdBooks = books.filter(b => b.is_creator);
this.joinedBooks = books.filter(b => !b.is_creator);
const defaultBook = books.find(b => b.is_default);

// 修复后
this.createdBooks = books.filter(b => b.is_creator === 1);
this.joinedBooks = books.filter(b => b.is_creator === 2);
const defaultBook = books.find(b => b.is_default === 1);
```

## 前端辅助函数建议

在 `/utils/` 目录下创建一个辅助函数文件，方便在整个项目中使用：

```javascript
// /utils/boolean-helpers.js

/**
 * 判断布尔值字段是否为真
 * @param {number} value - 字段值（1 或 2）
 * @returns {boolean}
 */
export const isTrue = (value) => value === 1;

/**
 * 判断布尔值字段是否为假
 * @param {number} value - 字段值（1 或 2）
 * @returns {boolean}
 */
export const isFalse = (value) => value === 2;

/**
 * 判断是否为创建者
 * @param {object} book - 账本对象
 * @returns {boolean}
 */
export const isBookCreator = (book) => book.is_creator === 1;

/**
 * 判断是否为默认账本
 * @param {object} book - 账本对象
 * @returns {boolean}
 */
export const isDefaultBook = (book) => book.is_default === 1;

/**
 * 判断用户是否启用
 * @param {object} user - 用户对象
 * @returns {boolean}
 */
export const isUserEnabled = (user) => user.is_disable === 1;

/**
 * 判断标签是否为系统标签
 * @param {object} tag - 标签对象
 * @returns {boolean}
 */
export const isSystemTag = (tag) => tag.is_system === 1;

/**
 * 判断交易是否为自动生成
 * @param {object} transaction - 交易对象
 * @returns {boolean}
 */
export const isAutoGenerated = (transaction) => transaction.is_auto_generated === 1;

/**
 * 判断周期记账是否启用
 * @param {object} recurring - 周期记账对象
 * @returns {boolean}
 */
export const isRecurringEnabled = (recurring) => recurring.is_recurring_enabled === 1;

/**
 * 判断节日是否显示在首页
 * @param {object} festival - 节日对象
 * @returns {boolean}
 */
export const isFestivalShownOnHome = (festival) => festival.is_show_home === 1;
```

## 使用示例

使用辅助函数后的代码会更清晰：

```javascript
import { isBookCreator, isDefaultBook } from '@/utils/boolean-helpers.js';

// 修复后的代码
this.createdBooks = data.filter(book => isBookCreator(book));
this.joinedBooks = data.filter(book => !isBookCreator(book));
const defaultBook = books.find(b => isDefaultBook(b)) || books[0];
```

## 检查清单

- [ ] 修复 `/pages/account-books/index.vue` 中的 `is_creator` 判定
- [ ] 修复 `/pages/record/index.vue` 中的 `is_creator` 和 `is_default` 判定
- [ ] 修复 `/pages/home/index.vue` 中的 `is_creator` 和 `is_default` 判定
- [ ] 创建 `/utils/boolean-helpers.js` 辅助函数文件
- [ ] 检查其他页面中是否还有布尔值判定问题
- [ ] 更新相关的 Vue 模板中的条件判定（v-if 等）

## 注意事项

1. **字符串比较**: 确保与数字 1 和 2 进行比较，而不是字符串 "1" 和 "2"
2. **模板中的判定**: 在 Vue 模板中使用 v-if 时，也需要使用 `=== 1` 的方式
3. **CSS 类绑定**: 如果使用 :class 绑定，需要确保条件判定正确
4. **计算属性**: 如果有计算属性涉及布尔值判定，也需要修复

## 示例：模板中的修复

```vue
<!-- 修复前 -->
<view v-if="book.is_creator" class="creator-badge">创建者</view>

<!-- 修复后 -->
<view v-if="book.is_creator === 1" class="creator-badge">创建者</view>
```
